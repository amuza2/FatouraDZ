<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:FatouraDZ.ViewModels"
             x:Class="FatouraDZ.Views.SettingsView"
             x:DataType="vm:SettingsViewModel">
    
    <Grid RowDefinitions="Auto,*">
        <!-- Header -->
        <Border Grid.Row="0" Background="#F8FAFC" Padding="30,20" BorderBrush="#E2E8F0" BorderThickness="0,0,0,1">
            <Grid ColumnDefinitions="Auto,*">
                <Button Grid.Column="0" Content="â† Retour" 
                        Command="{Binding GoBackCommand}"
                        Background="Transparent"
                        Foreground="#64748B"
                        Padding="10,8"
                        Margin="0,0,20,0"/>
                
                <StackPanel Grid.Column="1">
                    <TextBlock Text="ParamÃ¨tres" FontSize="24" FontWeight="Bold" Foreground="#1E293B"/>
                    <TextBlock Text="Configuration de l'application" Foreground="#64748B" FontSize="13"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Content with Tabs -->
        <TabControl Grid.Row="1" SelectedIndex="{Binding SelectedTabIndex}" Margin="30,20">
            <!-- Tab: Base de donnÃ©es -->
            <TabItem Header="ðŸ’¾ Base de donnÃ©es">
                <ScrollViewer Padding="20" VerticalScrollBarVisibility="Auto">
                    <StackPanel Spacing="20" MaxWidth="600" Margin="0,0,0,80">
                        <TextBlock Text="Gestion de la base de donnÃ©es" FontSize="18" FontWeight="SemiBold" Foreground="#1E293B"/>
                        <TextBlock Text="Exportez et importez vos donnÃ©es pour les sauvegarder ou les transfÃ©rer vers un autre appareil." 
                                   Foreground="#64748B" TextWrapping="Wrap"/>

                        <!-- Export Section -->
                        <Border Background="White" CornerRadius="8" Padding="20" BorderBrush="#E2E8F0" BorderThickness="1">
                            <StackPanel Spacing="15">
                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <TextBlock Text="ðŸ“¤" FontSize="24"/>
                                    <StackPanel>
                                        <TextBlock Text="Exporter la base de donnÃ©es" FontWeight="SemiBold" FontSize="14"/>
                                        <TextBlock Text="CrÃ©er une sauvegarde de toutes vos donnÃ©es" Foreground="#64748B" FontSize="12"/>
                                    </StackPanel>
                                </StackPanel>
                                <Button Content="Exporter maintenant" 
                                        Command="{Binding ExporterBaseDeDonneesCommand}"
                                        Padding="15,10"
                                        Background="#2563EB"
                                        Foreground="White"/>
                            </StackPanel>
                        </Border>

                        <!-- Import Section -->
                        <Border Background="White" CornerRadius="8" Padding="20" BorderBrush="#E2E8F0" BorderThickness="1">
                            <StackPanel Spacing="15">
                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <TextBlock Text="ðŸ“¥" FontSize="24"/>
                                    <StackPanel>
                                        <TextBlock Text="Importer une sauvegarde" FontWeight="SemiBold" FontSize="14"/>
                                        <TextBlock Text="Restaurer vos donnÃ©es depuis une sauvegarde" Foreground="#64748B" FontSize="12"/>
                                    </StackPanel>
                                </StackPanel>
                                <Button Content="Importer une sauvegarde" 
                                        Command="{Binding ImporterBaseDeDonneesCommand}"
                                        Padding="15,10"
                                        Background="#10B981"
                                        Foreground="White"/>
                            </StackPanel>
                        </Border>

                        <!-- Open Folder -->
                        <Border Background="White" CornerRadius="8" Padding="20" BorderBrush="#E2E8F0" BorderThickness="1">
                            <StackPanel Spacing="15">
                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <TextBlock Text="ðŸ“" FontSize="24"/>
                                    <StackPanel>
                                        <TextBlock Text="Dossier des sauvegardes" FontWeight="SemiBold" FontSize="14"/>
                                        <TextBlock Text="Ouvrir le dossier contenant les fichiers de sauvegarde" Foreground="#64748B" FontSize="12"/>
                                    </StackPanel>
                                </StackPanel>
                                <Button Content="Ouvrir le dossier" 
                                        Command="{Binding OuvrirDossierExportCommand}"
                                        Padding="15,10"
                                        Background="#6366F1"
                                        Foreground="White"/>
                            </StackPanel>
                        </Border>

                        <Separator Margin="0,10" Background="#E2E8F0"/>

                        <!-- Database Location -->
                        <Border Background="White" CornerRadius="8" Padding="20" BorderBrush="#E2E8F0" BorderThickness="1">
                            <StackPanel Spacing="15">
                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <TextBlock Text="ðŸ“" FontSize="24"/>
                                    <StackPanel>
                                        <TextBlock Text="Emplacement de la base de donnÃ©es" FontWeight="SemiBold" FontSize="14"/>
                                        <TextBlock Text="Changer l'emplacement oÃ¹ vos donnÃ©es sont stockÃ©es" Foreground="#64748B" FontSize="12"/>
                                    </StackPanel>
                                </StackPanel>
                                
                                <StackPanel Spacing="5">
                                    <TextBlock Text="Emplacement actuel :" FontWeight="Medium" FontSize="12"/>
                                    <TextBox Text="{Binding CheminBaseDeDonnees}" IsReadOnly="True" 
                                             Background="#F8FAFC" FontSize="11"/>
                                </StackPanel>

                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <Button Content="Changer l'emplacement" 
                                            Command="{Binding ChangerEmplacementBaseDeDonneesCommand}"
                                            Padding="15,10"
                                            Background="#F59E0B"
                                            Foreground="White"/>
                                    <Button Content="RÃ©initialiser" 
                                            Command="{Binding ReinitialiserEmplacementCommand}"
                                            Padding="15,10"
                                            Background="#94A3B8"
                                            Foreground="White"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>

                        <!-- Success Message -->
                        <Border Background="#D1FAE5" CornerRadius="8" Padding="15"
                                IsVisible="{Binding MessageSucces, Converter={x:Static StringConverters.IsNotNullOrEmpty}}">
                            <TextBlock Text="{Binding MessageSucces}" Foreground="#065F46" TextWrapping="Wrap"/>
                        </Border>

                        <!-- Error Message -->
                        <Border Background="#FEE2E2" CornerRadius="8" Padding="15"
                                IsVisible="{Binding MessageErreur, Converter={x:Static StringConverters.IsNotNullOrEmpty}}">
                            <TextBlock Text="{Binding MessageErreur}" Foreground="#DC2626" TextWrapping="Wrap"/>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Tab: ParamÃ¨tres fiscaux -->
            <TabItem Header="ðŸ“Š FiscalitÃ©">
                <ScrollViewer Padding="20" VerticalScrollBarVisibility="Auto">
                    <StackPanel Spacing="20" MaxWidth="600" Margin="0,0,0,80">
                        <TextBlock Text="ParamÃ¨tres fiscaux" FontSize="18" FontWeight="SemiBold" Foreground="#1E293B"/>
                        <TextBlock Text="Configurez les taux de TVA, timbre fiscal et autres paramÃ¨tres lÃ©gaux. Ces valeurs peuvent changer selon la lÃ©gislation en vigueur." 
                                   Foreground="#64748B" TextWrapping="Wrap"/>

                        <!-- TVA Section -->
                        <Border Background="White" CornerRadius="8" Padding="20" BorderBrush="#E2E8F0" BorderThickness="1">
                            <StackPanel Spacing="15">
                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <TextBlock Text="ðŸ’°" FontSize="24"/>
                                    <TextBlock Text="Taux de TVA" FontWeight="SemiBold" FontSize="14" VerticalAlignment="Center"/>
                                </StackPanel>
                                
                                <Grid ColumnDefinitions="*,20,*" RowDefinitions="Auto,Auto">
                                    <StackPanel Grid.Column="0" Spacing="5">
                                        <TextBlock Text="TVA Standard (%)" FontWeight="Medium" FontSize="12"/>
                                        <NumericUpDown Value="{Binding TauxTVAStandard}" Minimum="0" Maximum="100" Increment="0.5" FormatString="0.##"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="2" Spacing="5">
                                        <TextBlock Text="TVA RÃ©duit (%)" FontWeight="Medium" FontSize="12"/>
                                        <NumericUpDown Value="{Binding TauxTVAReduit}" Minimum="0" Maximum="100" Increment="0.5" FormatString="0.##"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </Border>

                        <!-- Timbre Fiscal Section -->
                        <Border Background="White" CornerRadius="8" Padding="20" BorderBrush="#E2E8F0" BorderThickness="1">
                            <StackPanel Spacing="15">
                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <TextBlock Text="ðŸ›ï¸" FontSize="24"/>
                                    <TextBlock Text="Timbre Fiscal" FontWeight="SemiBold" FontSize="14" VerticalAlignment="Center"/>
                                </StackPanel>
                                
                                <Grid ColumnDefinitions="*,20,*">
                                    <StackPanel Grid.Column="0" Spacing="5">
                                        <TextBlock Text="Taux (%)" FontWeight="Medium" FontSize="12"/>
                                        <NumericUpDown Value="{Binding TauxTimbreFiscal}" Minimum="0" Maximum="10" Increment="0.1" FormatString="0.##"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="2" Spacing="5">
                                        <TextBlock Text="Montant Maximum (DZD)" FontWeight="Medium" FontSize="12"/>
                                        <NumericUpDown Value="{Binding MontantMaxTimbre}" Minimum="0" Maximum="100000" Increment="100" FormatString="N0"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </Border>

                        <!-- Retenue Ã  la Source Section -->
                        <Border Background="White" CornerRadius="8" Padding="20" BorderBrush="#E2E8F0" BorderThickness="1">
                            <StackPanel Spacing="15">
                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <TextBlock Text="ðŸ“‹" FontSize="24"/>
                                    <TextBlock Text="Retenue Ã  la Source" FontWeight="SemiBold" FontSize="14" VerticalAlignment="Center"/>
                                </StackPanel>
                                
                                <StackPanel Spacing="5" MaxWidth="200" HorizontalAlignment="Left">
                                    <TextBlock Text="Taux par dÃ©faut (%)" FontWeight="Medium" FontSize="12"/>
                                    <NumericUpDown Value="{Binding TauxRetenueSourceDefaut}" Minimum="0" Maximum="50" Increment="0.5" FormatString="0.##"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>

                        <!-- Invoice Settings Section -->
                        <Border Background="White" CornerRadius="8" Padding="20" BorderBrush="#E2E8F0" BorderThickness="1">
                            <StackPanel Spacing="15">
                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <TextBlock Text="ðŸ“„" FontSize="24"/>
                                    <TextBlock Text="ParamÃ¨tres de facturation" FontWeight="SemiBold" FontSize="14" VerticalAlignment="Center"/>
                                </StackPanel>
                                
                                <Grid ColumnDefinitions="*,20,*">
                                    <StackPanel Grid.Column="0" Spacing="5">
                                        <TextBlock Text="Format numÃ©ro facture" FontWeight="Medium" FontSize="12"/>
                                        <TextBox Text="{Binding FormatNumeroFacture}"/>
                                        <TextBlock Text="Variables: {ANNEE}, {NUM}" FontSize="10" Foreground="#94A3B8"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="2" Spacing="5">
                                        <TextBlock Text="DÃ©lai paiement (jours)" FontWeight="Medium" FontSize="12"/>
                                        <NumericUpDown Value="{Binding DelaiPaiementDefaut}" Minimum="0" Maximum="365" Increment="1" FormatString="0"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </Border>

                        <!-- Action Buttons -->
                        <StackPanel Orientation="Horizontal" Spacing="10">
                            <Button Content="Enregistrer les paramÃ¨tres" 
                                    Command="{Binding EnregistrerParametresFiscauxCommand}"
                                    Padding="20,12"
                                    Background="#2563EB"
                                    Foreground="White"
                                    FontWeight="SemiBold"/>
                            <Button Content="RÃ©initialiser" 
                                    Command="{Binding ReinitialiserParametresFiscauxCommand}"
                                    Padding="20,12"
                                    Background="#94A3B8"
                                    Foreground="White"/>
                        </StackPanel>

                        <!-- Success Message -->
                        <Border Background="#D1FAE5" CornerRadius="8" Padding="15"
                                IsVisible="{Binding MessageSucces, Converter={x:Static StringConverters.IsNotNullOrEmpty}}">
                            <TextBlock Text="{Binding MessageSucces}" Foreground="#065F46" TextWrapping="Wrap"/>
                        </Border>

                        <!-- Error Message -->
                        <Border Background="#FEE2E2" CornerRadius="8" Padding="15"
                                IsVisible="{Binding MessageErreur, Converter={x:Static StringConverters.IsNotNullOrEmpty}}">
                            <TextBlock Text="{Binding MessageErreur}" Foreground="#DC2626" TextWrapping="Wrap"/>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Tab: Ã€ propos -->
            <TabItem Header="Ã€ propos">
                <ScrollViewer Padding="20" VerticalScrollBarVisibility="Auto">
                    <StackPanel Spacing="20" MaxWidth="600" HorizontalAlignment="Center" Margin="0,0,0,80">
                        <!-- App Logo/Title -->
                        <StackPanel HorizontalAlignment="Center" Spacing="10">
                            <Border Background="#2563EB" CornerRadius="16" Padding="20" HorizontalAlignment="Center">
                                <TextBlock Text="ðŸ“„" FontSize="48"/>
                            </Border>
                            <TextBlock Text="FatouraDZ" FontSize="28" FontWeight="Bold" Foreground="#1E293B" HorizontalAlignment="Center"/>
                            <TextBlock Text="{Binding Version, StringFormat='Version {0}'}" 
                                       FontSize="14" Foreground="#64748B" HorizontalAlignment="Center"/>
                        </StackPanel>

                        <!-- Description -->
                        <Border Background="White" CornerRadius="8" Padding="20" BorderBrush="#E2E8F0" BorderThickness="1">
                            <StackPanel Spacing="10">
                                <TextBlock Text="Description" FontWeight="SemiBold" FontSize="14"/>
                                <TextBlock Text="{Binding Description}" Foreground="#64748B" TextWrapping="Wrap"/>
                            </StackPanel>
                        </Border>

                        <!-- Features -->
                        <Border Background="White" CornerRadius="8" Padding="20" BorderBrush="#E2E8F0" BorderThickness="1">
                            <StackPanel Spacing="10">
                                <TextBlock Text="FonctionnalitÃ©s" FontWeight="SemiBold" FontSize="14"/>
                                <StackPanel Spacing="8">
                                    <TextBlock Text="âœ“ Gestion multi-entreprises" Foreground="#64748B"/>
                                    <TextBlock Text="âœ“ Factures, avoirs et proformas" Foreground="#64748B"/>
                                    <TextBlock Text="âœ“ TVA" Foreground="#64748B"/>
                                    <TextBlock Text="âœ“ Timbre fiscal automatique" Foreground="#64748B"/>
                                    <TextBlock Text="âœ“ Retenue Ã  la source" Foreground="#64748B"/>
                                    <TextBlock Text="âœ“ Export PDF" Foreground="#64748B"/>
                                    <TextBlock Text="âœ“ Sauvegarde et restauration" Foreground="#64748B"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>

                        <!-- Developer Info -->
                        <Border Background="White" CornerRadius="8" Padding="20" BorderBrush="#E2E8F0" BorderThickness="1">
                            <StackPanel Spacing="10">
                                <TextBlock Text="DÃ©veloppeur" FontWeight="SemiBold" FontSize="14"/>
                                <TextBlock Text="{Binding Developpeur}" Foreground="#64748B"/>
                                <TextBlock Text="{Binding Contact}" Foreground="#2563EB"/>
                            </StackPanel>
                        </Border>

                        <!-- Copyright -->
                        <TextBlock Text="Â© 2026 FatouraDZ. Tous droits rÃ©servÃ©s." 
                                   FontSize="12" Foreground="#94A3B8" HorizontalAlignment="Center"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
        </TabControl>
    </Grid>
</UserControl>
