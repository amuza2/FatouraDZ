<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:FatouraDZ.ViewModels"
             mc:Ignorable="d" d:DesignWidth="900" d:DesignHeight="800"
             x:Class="FatouraDZ.Views.EntrepreneurConfigView"
             x:DataType="vm:EntrepreneurConfigViewModel">

    <Design.DataContext>
        <vm:EntrepreneurConfigViewModel/>
    </Design.DataContext>

    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
        <StackPanel Spacing="20" MaxWidth="800" HorizontalAlignment="Center">
            
            <!-- Titre -->
            <TextBlock Text="Configuration de l'entrepreneur" 
                       FontSize="24" FontWeight="Bold" 
                       HorizontalAlignment="Center"
                       Margin="0,0,0,20"/>

            <!-- Message d'erreur global -->
            <Border Background="#FFEBEE" BorderBrush="#EF4444" BorderThickness="1" 
                    CornerRadius="4" Padding="10"
                    IsVisible="{Binding ErreurMessage, Converter={x:Static StringConverters.IsNotNullOrEmpty}}">
                <TextBlock Text="{Binding ErreurMessage}" Foreground="#EF4444" TextWrapping="Wrap"/>
            </Border>

            <!-- Message de succÃ¨s -->
            <Border Background="#E8F5E9" BorderBrush="#10B981" BorderThickness="1" 
                    CornerRadius="4" Padding="10"
                    IsVisible="{Binding EstSauvegarde}">
                <TextBlock Text="âœ“ Informations sauvegardÃ©es avec succÃ¨s" Foreground="#10B981"/>
            </Border>

            <!-- Section: Informations personnelles -->
            <Border Classes="card">
                <StackPanel Spacing="15">
                    <TextBlock Text="Informations personnelles" FontSize="16" FontWeight="SemiBold" Foreground="#2563EB"/>
                    
                    <!-- Nom complet -->
                    <StackPanel Spacing="4">
                        <TextBlock Text="Nom et prÃ©nom *" FontWeight="Medium"/>
                        <TextBox Text="{Binding NomComplet}" Watermark="Ex: Mohammed Chami"/>
                        <TextBlock Text="{Binding ErreurNomComplet}" Foreground="#EF4444" FontSize="12"
                                   IsVisible="{Binding ErreurNomComplet, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                    </StackPanel>

                    <!-- Raison sociale -->
                    <StackPanel Spacing="4">
                        <TextBlock Text="DÃ©nomination / Raison sociale (optionnel)" FontWeight="Medium"/>
                        <TextBox Text="{Binding RaisonSociale}" Watermark="Si applicable"/>
                    </StackPanel>

                    <!-- Forme juridique et ActivitÃ© -->
                    <Grid ColumnDefinitions="*,20,*">
                        <StackPanel Grid.Column="0" Spacing="4">
                            <TextBlock Text="Forme juridique" FontWeight="Medium"/>
                            <TextBox Text="{Binding FormeJuridique}" Watermark="Ex: EURL, SARL, Auto-entrepreneur"/>
                        </StackPanel>
                        <StackPanel Grid.Column="2" Spacing="4">
                            <TextBlock Text="ActivitÃ©" FontWeight="Medium"/>
                            <TextBox Text="{Binding Activite}" Watermark="Ex: Services informatiques"/>
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- Section: Adresse -->
            <Border Classes="card">
                <StackPanel Spacing="15">
                    <TextBlock Text="Adresse" FontSize="16" FontWeight="SemiBold" Foreground="#2563EB"/>
                    
                    <!-- Adresse -->
                    <StackPanel Spacing="4">
                        <TextBlock Text="Adresse complÃ¨te *" FontWeight="Medium"/>
                        <TextBox Text="{Binding Adresse}" Watermark="Rue, numÃ©ro, quartier"/>
                        <TextBlock Text="{Binding ErreurAdresse}" Foreground="#EF4444" FontSize="12"
                                   IsVisible="{Binding ErreurAdresse, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                    </StackPanel>

                    <!-- Ville et Wilaya -->
                    <Grid ColumnDefinitions="*,20,*">
                        <StackPanel Grid.Column="0" Spacing="4">
                            <TextBlock Text="Ville *" FontWeight="Medium"/>
                            <TextBox Text="{Binding Ville}" Watermark="Ex: Alger"/>
                            <TextBlock Text="{Binding ErreurVille}" Foreground="#EF4444" FontSize="12"
                                       IsVisible="{Binding ErreurVille, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                        </StackPanel>
                        <StackPanel Grid.Column="2" Spacing="4">
                            <TextBlock Text="Wilaya *" FontWeight="Medium"/>
                            <TextBox Text="{Binding Wilaya}" Watermark="Ex: Alger"/>
                            <TextBlock Text="{Binding ErreurWilaya}" Foreground="#EF4444" FontSize="12"
                                       IsVisible="{Binding ErreurWilaya, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                        </StackPanel>
                    </Grid>

                    <!-- Code postal -->
                    <StackPanel Spacing="4" MaxWidth="200" HorizontalAlignment="Left">
                        <TextBlock Text="Code postal" FontWeight="Medium"/>
                        <TextBox Text="{Binding CodePostal}" Watermark="Ex: 16000"/>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- Section: Contact -->
            <Border Classes="card">
                <StackPanel Spacing="15">
                    <TextBlock Text="Contact" FontSize="16" FontWeight="SemiBold" Foreground="#2563EB"/>
                    
                    <Grid ColumnDefinitions="*,20,*">
                        <!-- TÃ©lÃ©phone -->
                        <StackPanel Grid.Column="0" Spacing="4">
                            <TextBlock Text="TÃ©lÃ©phone *" FontWeight="Medium"/>
                            <TextBox Text="{Binding Telephone}" Watermark="05XX XX XX XX"/>
                            <TextBlock Text="{Binding ErreurTelephone}" Foreground="#EF4444" FontSize="12"
                                       IsVisible="{Binding ErreurTelephone, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                        </StackPanel>
                        
                        <!-- Email -->
                        <StackPanel Grid.Column="2" Spacing="4">
                            <TextBlock Text="Email" FontWeight="Medium"/>
                            <TextBox Text="{Binding Email}" Watermark="exemple@email.com"/>
                            <TextBlock Text="{Binding ErreurEmail}" Foreground="#EF4444" FontSize="12"
                                       IsVisible="{Binding ErreurEmail, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- Section: Informations fiscales -->
            <Border Classes="card">
                <StackPanel Spacing="15">
                    <TextBlock Text="Informations fiscales et lÃ©gales" FontSize="16" FontWeight="SemiBold" Foreground="#2563EB"/>
                    
                    <Grid ColumnDefinitions="*,20,*" RowDefinitions="Auto,15,Auto,15,Auto">
                        <!-- RC -->
                        <StackPanel Grid.Row="0" Grid.Column="0" Spacing="4">
                            <TextBlock Text="Registre du Commerce (RC) *" FontWeight="Medium"/>
                            <TextBox Text="{Binding Rc}" Watermark="NumÃ©ro RC"/>
                            <TextBlock Text="{Binding ErreurRC}" Foreground="#EF4444" FontSize="12"
                                       IsVisible="{Binding ErreurRC, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                        </StackPanel>
                        
                        <!-- NIS -->
                        <StackPanel Grid.Row="0" Grid.Column="2" Spacing="4">
                            <TextBlock Text="NIS (15 chiffres) *" FontWeight="Medium"/>
                            <TextBox Text="{Binding Nis}" Watermark="000000000000000"/>
                            <TextBlock Text="{Binding ErreurNIS}" Foreground="#EF4444" FontSize="12"
                                       IsVisible="{Binding ErreurNIS, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                        </StackPanel>
                        
                        <!-- NIF -->
                        <StackPanel Grid.Row="2" Grid.Column="0" Spacing="4">
                            <TextBlock Text="NIF *" FontWeight="Medium"/>
                            <TextBox Text="{Binding Nif}" Watermark="NumÃ©ro NIF"/>
                            <TextBlock Text="{Binding ErreurNIF}" Foreground="#EF4444" FontSize="12"
                                       IsVisible="{Binding ErreurNIF, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                        </StackPanel>
                        
                        <!-- AI -->
                        <StackPanel Grid.Row="2" Grid.Column="2" Spacing="4">
                            <TextBlock Text="Article d'Imposition (AI) *" FontWeight="Medium"/>
                            <TextBox Text="{Binding Ai}" Watermark="NumÃ©ro AI"/>
                            <TextBlock Text="{Binding ErreurAI}" Foreground="#EF4444" FontSize="12"
                                       IsVisible="{Binding ErreurAI, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                        </StackPanel>
                        
                        <!-- NumÃ©ro immatriculation -->
                        <StackPanel Grid.Row="4" Grid.Column="0" Spacing="4">
                            <TextBlock Text="NÂ° Immatriculation auto-entrepreneur *" FontWeight="Medium"/>
                            <TextBox Text="{Binding NumeroImmatriculation}" Watermark="NumÃ©ro"/>
                            <TextBlock Text="{Binding ErreurNumeroImmatriculation}" Foreground="#EF4444" FontSize="12"
                                       IsVisible="{Binding ErreurNumeroImmatriculation, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- Section: Capital social -->
            <Border Classes="card">
                <StackPanel Spacing="15">
                    <TextBlock Text="Capital social (optionnel)" FontSize="16" FontWeight="SemiBold" Foreground="#2563EB"/>
                    
                    <CheckBox Content="Capital social applicable" IsChecked="{Binding EstCapitalApplicable}"/>
                    
                    <StackPanel Spacing="4" IsVisible="{Binding EstCapitalApplicable}">
                        <TextBlock Text="Montant du capital social" FontWeight="Medium"/>
                        <TextBox Text="{Binding CapitalSocial}" Watermark="Ex: 100 000 DZD"/>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- Section: Logo -->
            <Border Classes="card">
                <StackPanel Spacing="15">
                    <TextBlock Text="Logo de l'entreprise (optionnel)" FontSize="16" FontWeight="SemiBold" Foreground="#2563EB"/>
                    <TextBlock Text="Format: PNG ou JPG, max 2 Mo" Foreground="#64748B" FontSize="12"/>
                    
                    <StackPanel Orientation="Horizontal" Spacing="10">
                        <Button Content="ðŸ“ SÃ©lectionner un logo" 
                                Command="{Binding SelectionnerLogoCommand}"
                                CommandParameter="{Binding $parent[Window].StorageProvider}"/>
                        <Button Content="ðŸ—‘ï¸ Supprimer" 
                                Command="{Binding SupprimerLogoCommand}"
                                IsVisible="{Binding CheminLogo, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                    </StackPanel>
                    
                    <!-- AperÃ§u du logo -->
                    <Border BorderBrush="#E2E8F0" BorderThickness="1" CornerRadius="4" 
                            Padding="10" MaxWidth="200" MaxHeight="100"
                            IsVisible="{Binding CheminLogo, Converter={x:Static StringConverters.IsNotNullOrEmpty}}">
                        <Image Source="{Binding CheminLogo}" Stretch="Uniform"/>
                    </Border>
                </StackPanel>
            </Border>

            <!-- Bouton Sauvegarder -->
            <Button Content="ðŸ’¾ Sauvegarder mes informations" 
                    Classes="primary"
                    Command="{Binding SauvegarderCommand}"
                    HorizontalAlignment="Center"
                    Padding="30,15"
                    FontSize="16"/>

            <TextBlock Text="* Champs obligatoires" 
                       Foreground="#64748B" FontSize="12" 
                       HorizontalAlignment="Center"
                       Margin="0,0,0,20"/>

        </StackPanel>
    </ScrollViewer>
</UserControl>
